<div class="min-h-screen bg-gray-100 flex items-center justify-center px-4">
  <div class="w-full max-w-md bg-white rounded-2xl shadow-lg p-8 space-y-6">
    <h2 class="text-2xl font-semibold text-center text-gray-800">
      Reset Password
    </h2>

    <!-- Step 1: Send OTP -->
    <div class="space-y-4" *ngIf="!otpSent && !otpVerified">
      <button
        type="button"
        (click)="sendOtp()"
        [disabled]="loading"
        class="w-full bg-indigo-600 text-white font-semibold py-2 rounded-lg hover:bg-indigo-700 flex justify-center items-center space-x-2 disabled:opacity-60"
      >
        <ng-container *ngIf="!loading; else loadingTpl">Send OTP</ng-container>
      </button>

    </div>

    <!-- Step 2: Verify OTP -->
    <div class="space-y-4" *ngIf="otpSent && !otpVerified">
      <input
        type="text"
        placeholder="Enter OTP"
        [(ngModel)]="otp"
        name="otp"
        class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-indigo-200"
      />
      <button
        type="button"
        (click)="verifyOtp()"
        [disabled]="loading"
        class="w-full bg-green-600 text-white font-semibold py-2 rounded-lg hover:bg-green-700 flex justify-center items-center space-x-2 disabled:opacity-60"
      >
        <ng-container *ngIf="!loading; else loadingTpl">Verify OTP</ng-container>
      </button>

    </div>

    <!-- Step 3: Set New Password -->
    <div class="space-y-4" *ngIf="otpVerified">
      <div class="relative w-full">
        <input
          [type]="showPassword ? 'text' : 'password'"
          placeholder="New Password"
          [(ngModel)]="newPassword"
          name="newPassword"
          class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-indigo-200 pr-10"
        />
        <button
          type="button"
          (click)="showPassword = !showPassword"
          class="absolute inset-y-0 right-0 flex items-center px-3 text-gray-600 focus:outline-none"
        >
          <fa-icon [icon]="showPassword ? faEyeSlash : faEye" class="h-5 w-5"></fa-icon>
        </button>
      </div>

      <div class="relative w-full">
        <input
          [type]="showPassword ? 'text' : 'password'"
          placeholder="Re-enter New Password"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-indigo-200 pr-10"
        />
        <button
          type="button"
          (click)="showPassword = !showPassword"
          class="absolute inset-y-0 right-0 flex items-center px-3 text-gray-600 focus:outline-none"
        >
          <fa-icon [icon]="showPassword ? faEyeSlash : faEye" class="h-5 w-5"></fa-icon>
        </button>
      </div>

      <button
        type="button"
        (click)="updatePassword()"
        [disabled]="loading"
        class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 flex justify-center items-center space-x-2 disabled:opacity-60"
      >
        <ng-container *ngIf="!loading; else loadingTpl">Update Password</ng-container>
      </button>

    </div>

    <!-- Optional: Back to Login -->
    <button
      type="button"
      routerLink="/admin/login"
      class="w-full bg-gray-200 text-gray-700 font-medium py-2 rounded-lg hover:bg-gray-300 flex justify-center items-center"
    >
      Back to Login
    </button>
  </div>
</div>

<ng-template #loadingTpl>
  <svg
    class="animate-spin h-5 w-5 text-white"
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
  >
    <circle
      class="opacity-25"
      cx="12"
      cy="12"
      r="10"
      stroke="currentColor"
      stroke-width="4"
    ></circle>
    <path
      class="opacity-75"
      fill="currentColor"
      d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
    ></path>
  </svg>
</ng-template>

